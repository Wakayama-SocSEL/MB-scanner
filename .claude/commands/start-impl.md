# 実装開始コマンド

このコマンドは、新機能の実装を開始するためのワークフローを提供します。

## 実行内容

### 1. 作業ディレクトリの準備

- `.ai/tasks/`ディレクトリ内に`4桁の連番_機能名`形式でディレクトリを作成します
  - 例: `.ai/tasks/0001_users-migration/`, `.ai/tasks/0002_babies-migration/`
- 既存の連番ディレクトリを確認し、次の番号を割り当てます
- 機能名はケバブケース（小文字とハイフン）を使用します

### 2. 実装開始の許可を得る

- **コードの変更は勝手に実施してはいけません**
- まず、`.ai/tasks/XXXX_機能名/plan.md`に作業のプランニングを作成します
- `plan.md`をユーザーに提示し、実装の許可を得ます
- 許可が得られるまで、ユーザーと相談しつつプランニングを繰り返します
- 同時に`.ai/tasks/XXXX_機能名/prompt.md`を作成し、ユーザー要望と対応内容を記録します

### 3. 作業の実施

- `plan.md`に記載されたプランに従って、作業を実施します
- ユーザーから指示があるたびに`prompt.md`を更新します
- 作業完了後にも`prompt.md`を更新します
- 作業完了ごとに、**テストの実施**と、**型チェック**、**フォーマット**の実施を行なってください。

## 実行方法

```bash
# テストの実行
uv run pytest

# 型チェック
just typecheck

# フォーマット＋自動修正
just fix

# 実行コマンド
uv run mb-scanner {}
詳細なコマンドは--helpにて確認可能
```

## ワークフロー

1. 🎯 **ユーザーから実装要望を受け取る**
2. 📁 **作業ディレクトリを作成**
   - 既存の`.ai/tasks/XXXX_*/`ディレクトリを確認
   - 次の連番でディレクトリ作成: `.ai/tasks/XXXX_機能名/`
3. 📋 **`.ai/tasks/XXXX_機能名/plan.md`にプランニングを作成**
4. 📝 **`.ai/tasks/XXXX_機能名/prompt.md`を作成**
   - ユーザー要望を記録
   - 対応内容を記録
   - 実装日時を記録
5. 👤 **ユーザーに`plan.md`を提示し、許可を求める**
6. 🔄 **許可が得られない場合、再度プランニング（3に戻る）**
7. ✅ **許可が得られたら、実装を開始**
8. 📝 **`prompt.md`を随時更新しながら作業**
9. 🧪 **実装完了ごとに以下を実施:**
   - テストの実施: `pytest`
   - 型チェック: `just typecheck`
   - フォーマット+自動修正: `just fix`
10. 📝 **作業完了後に`prompt.md`を更新**
11. 🎉 **完了報告**

## 注意事項

- プランニングなしで勝手にコードを変更しないこと
- ユーザーの許可を得てから実装を開始すること
- 各作業の完了時には必ず品質チェックを実施すること
- `.ai/tasks/XXXX_機能名/prompt.md`を常に最新の状態に保つこと
- 作業ディレクトリの連番は既存のディレクトリを確認して重複しないようにすること

## ディレクトリ構造例

```
.ai/tasks/
├── 0001_users-migration/
│   ├── plan.md
│   └── prompt.md
├── 0002_babies-migration/
│   ├── plan.md
│   └── prompt.md
└── 0003_analyses-migration/
    ├── plan.md
    └── prompt.md
```

## 連番の割り当て方法

```bash
# 既存の連番ディレクトリを確認
find .ai/tasks -maxdepth 1 -type d -name "[0-9][0-9][0-9][0-9]_*" | sort | tail -1

# 例: .ai/tasks/0001_users-migration が最新の場合
# 次は 0002 を使用する
```

## 関連ドキュメント

- [プロジェクト概要](../../ai-guide/project-overview.md)
- [データベース設計](../../ai-guide/database-design.md)
- [テストガイドライン（必読）](../../ai-guide/testing-guidelines.md)
